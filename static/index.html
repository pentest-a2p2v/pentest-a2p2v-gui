<!DOCTYPE html>
<!-- SPDX-License-Identifier: Apache-2.0 -->
<!-- See README.md for license details -->
<html>

<head>
  <meta charset="utf-8" />
  <title>Automated Attack Path Planning and Validation (GUI)</title>
  <link rel="stylesheet" type="text/css" href="thirdparty/jquery-ui.min.css">
  <link rel="stylesheet" type="text/css" href="css/app.css">
  <script src="thirdparty/jquery-3.6.0.min.js"></script>
  <script src="thirdparty/jquery-ui.min.js"></script>
  <script src="js/send_server_program.js"></script>
  <script src="js/visualize_attack_paths.js"></script>
</head>

<body>
  <div class="header">
    <div id="date"></div>
  </div>

  <h1 id="main-title">Attack Path Planner</h1>

  <!-- Main -->
  <div class="screen-area" id="screen-area">

    <!-- ========== Initial Configuration Pane ========== -->
    <div id="file_import" style="width: 90%; margin-left:auto; margin-right:auto;">
      <h2 class="title" style="margin-top: 0.2vh;">Input Configuration</h2>
      <div id="input_header_tab">
        <div class="tab-wrap">

          <input id="INPUT_TAB_01" type="radio" name="INPUT_TAB_h" class="tab-switch" checked="checked" />
          <label class="tab-label" for="INPUT_TAB_01">Run Attack Path Planner</label>
          <div class="tab-content">
            <!-- Load network configuration file -->
            <div style="margin-top: 1.5vh; text-align: center; line-height: 2em;">
              Network configuration file (.xml):<br />
              <input type="button" id="xml_file_button" value="File" class="log-button" onclick="openFile_xml()"
                style="display:inline" />
              <input type="text" id="xml_text" value="" class="log-text" style="display:inline" readonly />
              <input type="file" id="xml_file" value="" accept=".xml" hidden />
            </div>
            <!-- Load scan result file -->
            <div style="margin-top: 1.5vh; text-align: center; line-height: 2em;">
              Scan Result file (.common, .nessus, .nmap):<br />
              <input type="button" id="scan_result_file_button" value="File" class="log-button"
                onclick="openFile_scan_result()" style="display:inline" />
              <input type="text" id="scan_result_text" value="" class="log-text" style="display:inline" readonly />
              <input type="file" id="scan_result_file" value="" accept=".common,.nessus,.nmap" hidden />
            </div>
            <div style="margin-top: 3.0vh; margin-bottom: 1.0vh; font-size: 1.1vw; text-align: center;">
              <input type="submit" id="import_button" value="import" class="display-button"
                onclick="import_files('xml_file', 'scan_result_file', 2)" />
            </div>
          </div>

          <input id="INPUT_TAB_02" type="radio" name="INPUT_TAB_h" class="tab-switch" />
          <label class="tab-label" for="INPUT_TAB_02">Visualize Generated Attack Paths</label>
          <div class="tab-content">
            <!-- Load log file -->
            <div style="margin-top: 1.5vh; text-align: center; line-height: 2em;">
              Network configuration file (.xml):<br />
              <input type="button" id="visualization_xml_file_button" value="File" class="log-button"
                onclick="visualization_openFile_xml()" style="display:inline" />
              <input type="text" id="visualization_xml_text" value="" class="log-text" style="display:inline"
                readonly />
              <input type="file" id="visualization_xml_file" value="" accept=".xml" hidden />
            </div>
            <div style="margin-top: 1.5vh; text-align: center; line-height: 2em;">
              Attack Path Result file (.json):<br />
              <input type="button" id="route_file_button" value="File" class="log-button" onclick="openFile_route()"
                style="display:inline" />
              <input type="text" id="route_text" value="" class="log-text" style="display:inline" readonly />
              <input type="file" id="route_file" value="" accept=".json" hidden />
            </div>
            <div style="margin-top: 3.0vh; margin-bottom: 1.0vh; font-size: 1.1vw; text-align: center;">
              <input type="submit" id="visualization_import_button" value="import" class="display-button"
                onclick="import_files('visualization_xml_file', 'route_file', 1)" />
            </div>
          </div>

          <!--tab-content end-->
        </div>
      </div>
    </div>

    <!-- ========== Network Display Pane ========== -->
    <div id="network_disp" style="display: none; height: 90%;">
      <span class="back"><input type="button" id="back_to_top_button1" value="back to top" class="back-button"
          onclick="back_to_top()" /></span>
      <div style="text-align: center; margin-top: 1.5vh;">
        <!-- Network Diagram -->
        <div style="width: 50%; display: inline-block; vertical-align: top;">
          <h2 class="title" style="margin-top: 1.5vh;">Network</h2>
          <div id="network_canvas_div">
            <canvas id="network0" width="1250" height="800"></canvas>
          </div>
        </div>
        <!-- Form for Input Parameters -->
        <div style="width: 40%; display: inline-block; vertical-align: top;">
          <h2 class="title">Parameters</h2>
          <fieldset>
            <legend>Initial State</legend>
            <label for="attacking_host">Attacking host</label>
            <select name="attacking_host" id="attacking_host"
              style="margin-left: 0.4vw;font-size: 1.1vw;width: 60%"></select>
          </fieldset>
          <fieldset>
            <legend>Goal</legend>
            <div class="goal_grid">
              <label for="target_host">Target host</label>
              <select name="target_host" id="target_host"
                style="margin-left: 0.4vw;font-size: 1.1vw;width: 90%"></select>
            </div>
            <div class="goal_grid">
              <span style="padding-left: 2em;">&lt;or&gt;</span>
            </div>
            <div class="goal_grid">
              <label for="target_state">Target state</label>
              <input type="text" id="target_state" value="" maxlength="70"
                style="margin-left: 0.4vw;font-size: 1.1vw;width: 90%" />
            </div>
          </fieldset>
          <fieldset>
            <legend>Search Configuration</legend>
              <label for="max_hops">Maximum Attack Steps (0: infinite)</label>
              <input type="number" id="max_hops" value="0" style="margin-left: 0.4vw;font-size: 1.1vw;">
          </fieldset>
          <input type="submit" id="search_button" value="Search Attack Path" class="search-button"
            onclick="buttonClickAttackPathSearch()" style="display: inline-block; vertical-align: top;" />
        </div>
      </div>
    </div>

    <!-- ========== Attack Path Pane ========== -->
    <div id="network_attack" style="display: none; width: 95%; height: 100%; margin-left:auto; margin-right:auto;">
      <!-- Display -->
      <h2 class="title" style="margin-top: 0.5vh;">Attack Paths</h2>
      <span class="back">
        <input type="button" id="back_to_network_button" value="back" class="back-button"
          onclick="back_to_network_selection()" style="display: none" />
        <input type="button" id="back_to_top_button2" value="back to top" class="back-button" onclick="back_to_top()" />
      </span>
      <div id="header_tab" style="width: 98%; height: 80vh;">
        <div class="tab-wrap" id="sc_tabs">
        </div>
      </div>
      <div style="text-align: right">
        <input type="button" id="download_link_button" value="Download Attack Paths (.json)" class="download-button"
          onclick="download_attack_paths()" style="display: none" />
        <a id="download_link" download="attack_paths.json" style="display: none" href="#">Download Attack Path (JSON)</a>
      </div>
    </div>
  </div>

</body>

</html>
